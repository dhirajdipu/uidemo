!function(i){"function"==typeof define&&define.amd?define(["jquery"],i):"object"==typeof module&&module.exports?module.exports=function(t,e){return void 0===e&&(e="undefined"!=typeof window?require("jquery"):require("jquery")(t)),i(e),e}:i(window.Zepto||window.jQuery)}(function(h){var i="mousedown touchstart MSPointerDown pointerdown",o="mouseup touchend MSPointerUp pointerup",n="mousemove touchmove MSPointerMove pointermove scroll";function c(t,e,i){a("transform",t,"translate("+e+"px, "+i+"px)")}function r(t,e){a("transition",t,e)}function p(t){return t=t.originalEvent||t,window.event&&window.event.changedTouches&&event.changedTouches[0].pageX||t.pageX}function d(t){return t=t.originalEvent||t,window.event&&window.event.changedTouches&&event.changedTouches[0].pageY||t.pageY}function a(t,e,i){for(var s=(t=t.toLowerCase()).charAt(0).toUpperCase()+t.substr(1),o=["webkit","Moz","ms","O"].map(function(t){return t+s}).concat("transform"),n=0,r=o.length;n<r;++n)if(o[n]in e.style){if(void 0===i)return e.style[o[n]];e.style[o[n]]=i;break}}var l=["altKey","bubbles","button","cancelable","charCode","clientX","clientY","ctrlKey","currentTarget","data","detail","eventPhase","metaKey","offsetX","offsetY","originalTarget","pageX","pageY","relatedTarget","screenX","screenY","shiftKey","target","view","which"];function f(t,e,i,s){if(t[0]){i=i.originalEvent||i;var o={};l.forEach(function(t){o[t]=i[t]}),o.currentTarget=o.target=t[0];var n=(t[0].ownerDocument.defaultView||t[0].ownerDocument.parentWindow).Zepto||h,e=n.Event(e,o);return n(t[0]).trigger(e,s),e}}var u,s=0,t=function(){var e;this.eventHandler=h("<div />"),this.parent=this.el=this.handle=null,this.origin={x:0,y:0,transition:null,translate:null,offset:{x:0,y:0}},this.lastEntered=this.currentTarget=null,this.lastX=this.lastY=this.lastDirection=null,this.originalCss={},this.windows=[window],Object.defineProperty(this,"placeholder",{get:function(){return e},set:function(t){e!==t&&(e&&e.remove(),e=t)}})};t.prototype.on=function(){return this.eventHandler.on.apply(this.eventHandler,Array.prototype.slice.call(arguments)),this},t.prototype.off=function(){return this.eventHandler.off.apply(this.eventHandler,Array.prototype.slice.call(arguments)),this},t.prototype.start=function(t,e,i,s){this.parent=t,this.el=e,this.handle=s;e=this.handle||this.el;this.origin.x=p(i),this.origin.y=d(i),this.origin.transform=a("transform",this.el[0]),this.origin.transition=a("transition",this.el[0]);s=this.el[0].getBoundingClientRect();return this.origin.offset.x=s.left+(window.scrollX||window.pageXOffset)-this.origin.x,this.origin.offset.y=s.top+(window.scrollY||window.pageYOffset)-this.origin.y,this.origin.scrollX=window.scrollX||window.pageXOffset,this.origin.scrollY=window.scrollY||window.pageYOffset,e[0].style.pointerEvents="none",this.windows.forEach(function(t){h(t).on(n,h.proxy(this.move,this)),h(t).on(o,h.proxy(this.stop,this))},this),r(e[0],""),f(this.eventHandler,"dragging:start",i),this.el},t.prototype.stop=function(t){var e;if(this.last&&(e=this.last,this.last=null,f(h(e),"dragging:drop",t).isDefaultPrevented()),this.el){for(var i in this.originalCss)this.el.css(i,this.originalCss[i]),delete this.originalCss[i];f(this.eventHandler,"dragging:stop",t,this.el),this.placeholder=null,this.handle||this.adjustPlacement(t);t=this.el;this.handle&&this.handle.remove(),setTimeout(function(t,e){r(t[0],"all 0.25s ease-in-out 0s"),a("transform",t[0],e.transform||""),setTimeout(r.bind(null,t[0],e.transition||""),250),t[0].style.pointerEvents=""}.bind(null,t,this.origin)),this.windows.forEach(function(t){h(t).off(n,this.move),h(t).off(o,this.stop)},this),this.parent=this.el=this.handle=null}},t.prototype.move=function(t){var e,i,s,o,n,r,a,l;this.el&&(r=(e=this.el[0].ownerDocument).defaultView||e.parentWindow,"scroll"!==t.type?(o=p(t),n=d(t),t.view!==r&&t.view.frameElement&&(o+=t.view.frameElement.offsetLeft,n+=t.view.frameElement.offsetTop),l=t.clientX||t.originalEvent&&t.originalEvent.clientX||window.event&&window.event.touches&&window.event.touches[0].clientX||0,s=t.clientY||t.originalEvent&&t.originalEvent.clientY||window.event&&window.event.touches&&window.event.touches[0].clientY||0,e=this.el[0].ownerDocument,i=w?(i=t.view.document.msElementsFromPoint(l,s))[0]===this.el[0]?i[1]:i[0]:t.view.document.elementFromPoint(l,s),a=this.lastX-o,s=(0<(l=this.lastY-n)?"up":l<0&&"down")||0<a&&"up"||a<0&&"down"||this.lastDirection,u.currentTarget||this.setCurrent(i),this.currentTarget&&(i!==this.last&&this.lastEntered!==this.currentTarget?(f(h(this.lastEntered),"dragging:leave",t),f(h(this.currentTarget),"dragging:enter",t),this.lastEntered=this.currentTarget):s!==this.lastDirection&&f(h(this.currentTarget),"dragging:diverted",t)),this.last=i,this.currentTarget=null,this.lastDirection=s,this.lastX=o,this.lastY=n,this.origin.scrollX=window.scrollX||window.pageXOffset,this.origin.scrollY=window.scrollY||window.pageYOffset):(o=this.lastX+((window.scrollX||window.pageXOffset)-this.origin.scrollX),n=this.lastY+((window.scrollY||window.pageYOffset)-this.origin.scrollY)),t.view!==r&&t.view&&t.view.frameElement&&(r=-1*(n-(window.scrollY||window.pageYOffset)-window.innerHeight),t=document.documentElement.offsetHeight<(window.scrollY||window.pageYOffset)+window.innerHeight,r<=10&&!t&&setTimeout(function(){window.scrollBy(0,5)},50),r=n-(window.scrollY||window.pageYOffset),t=(window.scrollY||window.pageYOffset)<=0,r<=10&&!t&&setTimeout(function(){window.scrollBy(0,-5)},50)),a=o-this.origin.x,l=n-this.origin.y,c((this.handle||this.el)[0],a,l))},t.prototype.setCurrent=function(t){this.currentTarget=t},t.prototype.css=function(t,e){this.el&&(this.originalCss[t]=this.el.css(t),this.el.css(t,e))},t.prototype.adjustPlacement=function(t){var e=this.handle&&this.handle[0]||this.el[0];c(e,0,0);var i=e.getBoundingClientRect();this.origin.x=i.left+(window.scrollX||window.pageXOffset)-this.origin.offset.x,this.origin.y=i.top+(window.scrollY||window.pageYOffset)-this.origin.offset.y;i=p(t)||this.lastX,t=d(t)||this.lastY;c(e,i-this.origin.x,t-this.origin.y)};try{parent.$&&parent.$.dragging&&(u=parent.$.dragging).windows.push(window)}catch(t){}u=h.dragging=u||new t;var g=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;function v(t){return Array.prototype.slice.call(t)}var w=!1;void 0===g&&((g=function(e){this.targets=[],this.onAdded=function(t){e([{addedNodes:[t.target],removedNodes:[]}])},this.onRemoved=function(t){e([{addedNodes:[],removedNodes:[t.target]}])}}).prototype.observe=function(t){t.addEventListener("DOMNodeInserted",this.onAdded),t.addEventListener("DOMNodeRemoved",this.onRemoved),this.targets.push(t)},g.prototype.disconnect=function(){for(var t;t=this.targets.shift();)t.removeEventListener("DOMNodeInserted",this.onAdded),t.removeEventListener("DOMNodeRemoved",this.onRemoved)},w=!!~navigator.appName.indexOf("Internet Explorer"));function m(t,r,s,o){var a=this;this.targets=t instanceof NodeList?Array.prototype.slice.call(t):[t];var l=">"===r[0],h=l?r.substr(1):r,n=!1;function c(t,o){var n=[];return v(t).forEach(function(t){var e,i,s;1===t.nodeType&&(l&&-1===a.targets.indexOf(t.parentNode)||(i=h,(s=(e=t).matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.oMatchesSelector)&&s.call(e,i)&&n.push(t),!l&&o&&v(t.querySelectorAll(r)).forEach(function(t){n.push(t)})))}),n}function p(t,e,i){i&&c(t,e).filter(function(t,e,i){return i.indexOf(t)===e}).forEach(function(t){i.call(t)})}var e=null,d=[],f=[];function i(){a.disconnect();for(var t=0,e=f.length;t<e;++t){var i=d.indexOf(f[t]);-1<i&&(d.splice(i,1),f.splice(t--,1))}p(d,!(n&&w),s),p(f,!0,o),d.length=0,f.length=0,a.observe()}this.observer=new g(function(t){t.forEach(function(t){d.push.apply(d,t.addedNodes),f.push.apply(f,t.removedNodes)}),e&&clearTimeout(e),e=setTimeout(i)}),s&&this.targets.forEach(function(t){p(t.children,!0,s)}),n=!0,this.observe()}m.prototype.disconnect=function(){this.observer.disconnect()},m.prototype.observe=function(){var e=this;this.targets.forEach(function(t){e.observer.observe(t,{childList:!0,subtree:!0})})};function e(t,e){this.id=s++,this.el=h(t),this.opts=e,this.cancel=!1!==e.handle}e.prototype.create=function(){this.el.on(i,h.proxy(this.start,this)).css("touch-action","double-tap-zoom").css("-ms-touch-action","double-tap-zoom"),u.on("dragging:stop",h.proxy(this.reset,this));var t=this;setTimeout(function(){t.el.trigger("draggable:create",t)})},e.prototype.destroy=function(){this.el.off(i,this.start),u.off("dragging:stop",this.reset)},e.prototype.enable=function(){this.opts.disabled=!1},e.prototype.disable=function(){this.opts.disabled=!0},e.prototype.start=function(t){if(this.opts.disabled)return!1;if("mousedown"===t.type&&1!==t.which)return!1;if(t=t.originalEvent||t,this.opts.cancel)for(var e=h(t.target);e[0]!==this.el[0];){if(e.is(this.opts.cancel))return;e=e.parent()}if(this.opts.handle){for(var e=h(t.target),i=!1;e[0]!==this.el[0];){if(e.is(this.opts.handle)){i=!0;break}e=e.parent()}if(!i)return}t.preventDefault();var s,o;this.el;this.opts.clone&&("function"==typeof this.opts.clone?s=this.opts.clone.call(this.el):(s=this.el.clone(),this.opts.cloneClass&&s.addClass(this.opts.cloneClass)),o=this.el.position(),s.css("position","absolute").css("left",o.left).css("top",o.top).width(this.el.width()).height(this.el.height()),s.insertAfter(this.el)),u.start(this,this.el,t,s),f(this.el,"draggable:start",t,{item:u.el})},e.prototype.reset=function(t,e){e===this.el[0]&&f(this.el,"draggable:stop",t,{item:u.el})};function y(t,e){this.id=s++,this.el=h(t),this.opts=e,this.accept=!1}y.prototype.create=function(){this.el.on("dragging:enter",h.proxy(this.enter,this)).on("dragging:leave",h.proxy(this.leave,this)).on("dragging:drop",h.proxy(this.drop,this)),u.on("dragging:start",h.proxy(this.activate,this)).on("dragging:stop",h.proxy(this.reset,this));var t=this;setTimeout(function(){t.el.trigger("droppable:create",t)})},y.prototype.destroy=function(){this.el.off("dragging:enter",this.enter).off("dragging:leave",this.leave).off("dragging:drop",this.drop)},y.prototype.enable=function(){this.opts.disabled=!1},y.prototype.disable=function(){this.opts.disabled=!0},y.prototype.activate=function(t){var e;this.accept=u.parent.opts.connectWith&&this.el.is(u.parent.opts.connectWith),this.accept||(e="*"===this.opts.accept||("function"==typeof this.opts.accept?this.opts.accept.call(this.el[0],u.el):u.el.is(this.opts.accept)),"default"!==this.opts.scope?(this.accept=u.parent.opts.scope===this.opts.scope,this.accept||"*"===this.opts.accept||(this.accept=e)):this.accept=e),this.accept&&(this.opts.activeClass&&this.el.addClass(this.opts.activeClass),f(this.el,"droppable:activate",t,{item:u.el}))},y.prototype.reset=function(t){this.accept&&(this.opts.activeClass&&this.el.removeClass(this.opts.activeClass),this.opts.hoverClass&&this.el.removeClass(this.opts.hoverClass),f(this.el,"droppable:deactivate",t,{item:u.el}))},y.prototype.enter=function(t){if(this.opts.disabled)return!1;t.stopPropagation(),u.placeholder&&u.placeholder.hide(),this.accept&&(this.opts.hoverClass&&this.el.addClass(this.opts.hoverClass),f(this.el,"droppable:over",t,{item:u.el}))},y.prototype.leave=function(t){if(this.opts.disabled)return!1;this.opts.hoverClass&&this.accept&&this.el.removeClass(this.opts.hoverClass),f(this.el,"droppable:out",t,{item:u.el})},y.prototype.drop=function(t){if(this.opts.disabled||!this.accept)return!1;var e,i,s;u.el&&(s=u.el,e="function"==typeof this.opts.receiveHandler&&this.opts.receiveHandler,i={item:s},s=null,u.handle&&(i.helper=u.handle,e||(s=i.clone=u.el.clone())),f(this.el,"droppable:drop",t,i).isDefaultPrevented()||(e?e.call(this.el,i):h(this.el).append(s||u.el)))};t=function(t,e){this.id=s++,this.el=t,this.opts=e;var i=this.opts.placeholderTag;if(!i)try{i=this.el.find(this.opts.items)[0].tagName}catch(t){i=/^ul|ol$/i.test(this.el[0].tagName)?"li":"div"}this.placeholder=h("<"+i+' id="__ph'+this.id+'" class="'+this.opts.placeholder+'" />'),this.accept=this.index=this.direction=null};function b(n,r,a){return function(e,i,s){var o=[];return this.each(function(){var t=h(this).data(r);if("string"==typeof e){if(void 0===t)throw new Error(r+" not defined");switch(e){case"enable":t.enable();break;case"disable":t.disable();break;case"destroy":t.destroy(),h(this).removeData(r);break;case"option":void 0!==s?t.opts[i]=s:"object"==typeof i?t.opts=h.extend(t.opts,i):i?o.push(t.opts[i]):o.push(t.opts);break;case"toArray":if("sortable"!==r)return;o.push(t.toArray(i))}}else{if(t)return h.extend(t.opts,e),this;(t=new n(h(this),h.extend({},a,e))).create(),h(this).data(r,t)}}),o.length?1===o.length?o[0]:o:this}}t.prototype.create=function(){this.el.on(i,this.opts.items,h.proxy(this.start,this)).on("dragging:enter",this.opts.items,h.proxy(this.enter,this)).on("dragging:diverted",this.opts.items,h.proxy(this.diverted,this)).on("dragging:drop",this.opts.items,h.proxy(this.drop,this)),h(this.el).find(this.opts.items).css("touch-action","double-tap-zoom").css("-ms-touch-action","double-tap-zoom"),this.el.on("dragging:enter",h.proxy(this.enter,this)).on("dragging:diverted",h.proxy(this.diverted,this)).on("dragging:drop",h.proxy(this.drop,this)),u.on("dragging:start",h.proxy(this.activate,this)).on("dragging:stop",h.proxy(this.reset,this));var e=this;setTimeout(function(){e.el.trigger("sortable:create",e)}),this.observer=new m(this.el[0],this.opts.items,function(){},function(){var t;this===e.placeholder[0]||u.el&&this===u.el[0]||((t=h(this)).css("touch-action","double-tap-zoom").css("-ms-touch-action","double-tap-zoom"),e.el.trigger("sortable:change",{item:t}),e.el.trigger("sortable:update",{item:t,index:-1}))})},t.prototype.destroy=function(){this.el.off(i,this.opts.items,this.start).off("dragging:enter",this.opts.items,this.enter).off("dragging:diverted",this.opts.items,this.diverted).off("dragging:drop",this.opts.items,this.drop),this.el.off("dragging:enter",this.enter).off("dragging:diverted",this.diverted).off("dragging:drop",this.drop),this.observer.disconnect()},t.prototype.enable=function(){this.opts.disabled=!1},t.prototype.disable=function(){this.opts.disabled=!0},t.prototype.activate=function(t){this.isEmpty=0===this.el.find(this.opts.items).length,this.accept=u.parent.id===this.id,!this.accept&&u.parent.opts.connectWith&&(this.accept=this.el.is(u.parent.opts.connectWith)),this.accept&&(this.accept=u.parent.id===this.id||"*"===this.opts.accept||("function"==typeof this.opts.accept?this.opts.accept.call(this.el[0],u.el):u.el.is(this.opts.accept)),this.accept&&(this.opts.activeClass&&this.el.addClass(this.opts.activeClass),f(this.el,"sortable:activate",t,{item:u.el})))},t.prototype.reset=function(t){this.accept&&(this.opts.activeClass&&this.el.removeClass(this.opts.activeClass),f(this.el,"sortable:deactivate",t,{item:u.el}),null!==this.index&&(f(this.el,"sortable:beforeStop",t,{item:u.el}),f(this.el,"sortable:stop",t,{item:u.el}),this.index=null))},t.prototype.indexOf=function(t){return this.el.find(this.opts.items+", #"+this.placeholder.attr("id")).index(t)},t.prototype.start=function(t){if(!this.opts.disabled&&!u.el){if("mousedown"===t.type&&1!==t.which)return!1;if(this.opts.cancel)for(var e=h(t.target);e[0]!==this.el[0];){if(e.is(this.opts.cancel))return;e=e.parent()}if(this.opts.handle){for(var e=h(t.target),i=!1;e[0]!==this.el[0];){if(e.is(this.opts.handle)){i=!0;break}e=e.parent()}if(!i)return}var s;t.stopPropagation(),t.preventDefault(),u.start(this,h(t.currentTarget),t),this.index=this.indexOf(u.el),u.el.before(u.placeholder=this.placeholder.show()),null!==this.index&&(s=u.el.outerHeight?u.el.outerHeight():u.el.height(),u.css("margin-bottom",-s)),this.opts.forcePlaceholderSize&&(this.placeholder.height(parseFloat(u.el.css("height"))),this.placeholder.width(parseFloat(u.el.css("width")))),u.adjustPlacement(t),f(this.el,"sortable:start",t,{item:u.el})}},t.prototype.enter=function(t){var e,i;this.accept&&!this.opts.disabled&&(t.stopPropagation(),i=(e=t.currentTarget)===this.el[0],e!==this.placeholder[0]&&(e=h(e),i&&!this.isEmpty&&this.placeholder.parent().length||(u.placeholder=this.placeholder,this.opts.forcePlaceholderSize&&(this.placeholder.height(parseFloat(u.el.css("height"))),this.placeholder.width(parseFloat(u.el.css("width")))),i?(this.el.append(this.placeholder),this.el.trigger("sortable:change",{item:u.el})):this.diverted(t))))},t.prototype.diverted=function(t){var e;this.accept&&!this.opts.disabled&&(t.stopPropagation(),(e=h(t.currentTarget))[0]===this.el[0]||(u.placeholder=this.placeholder,this.direction=this.indexOf(this.placeholder.show())<this.indexOf(e)?"down":"up",e["down"===this.direction?"after":"before"](this.placeholder),u.adjustPlacement(t),this.el.trigger("sortable:change",{item:u.el})))},t.prototype.drop=function(t){var e,i,s;this.accept&&!this.opts.disabled&&(t.stopPropagation(),t.preventDefault(),u.el&&this.placeholder.parent().length&&(f(this.el,"sortable:beforeStop",t,{item:u.el}),this.observer.disconnect(),(e=this.indexOf(this.placeholder))>this.index&&e--,i=null===this.index?this.opts.receiveHandler:this.opts.updateHandler||this.opts.updatePosition,s=u.el,"function"==typeof i?i.call(this.el,{item:u.el,index:e}):(u.handle&&(s=u.el.clone()),s.insertBefore(this.placeholder)),null===this.index&&f(this.el,"sortable:receive",t,{item:s}),e!==this.index&&this.el.trigger("sortable:update",{item:s,index:e}),f(this.el,"sortable:stop",t,{item:s}),this.index=null,this.observer.observe(),u.stop(t)))},t.prototype.toArray=function(t){var e=(t=t||{}).attribute||"id",i=[];return this.el.find(this.opts.items).each(function(){i.push(h(this).prop(e))}),i},h.fn.draggable=b(e,"draggable",{cancel:"input, textarea, button, select, option",connectWith:!1,cursor:"auto",disabled:!1,handle:!1,initialized:!1,clone:!1,cloneClass:"",scope:"default"}),h.fn.droppable=b(y,"droppable",{accept:"*",activeClass:"",disabled:!1,hoverClass:"",initialized:!1,scope:"default",receiveHandler:null}),h.fn.sortable=b(t,"sortable",{accept:"*",activeClass:"",cancel:"input, textarea, button, select, option",connectWith:!1,disabled:!1,forcePlaceholderSize:!1,handle:!1,initialized:!1,items:"li, div",placeholder:"placeholder",placeholderTag:null,updateHandler:null,receiveHandler:null})});